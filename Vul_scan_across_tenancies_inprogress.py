# Pre-requisites for running this script:
# *python 3.6
# *oci-cli should be pre-installed and configured.
# *oci-sdk should be pre-installed. Hint: run 'pip install oci' or 'yum install oci'
import time
start_time = time.time()
import oci
import sys
import os
import json
import configparser
from Report import Report
from ReportNetwork import ReportNetwork
from Vulnerablity import Vulnerability


new_words =["orasenatdpltintegration02",
"orasenatdpltintegration01",
"orasenatdoracledigital01",
"orasenatdoracledigital02",
"orasenatdoracledigital04",
"orasenatdoracledigital05",
"orasenatdecaretlhealth01",
"orasenatdpltoci01",
"orasenatdhubsred01",
"orasenatdhubsblue02",
"orasenatdpltinfomgmt01",
"orasenatdpltinfomgmt02",
"orasenatdpltoci02",
"orasenatdpltoci04",
"orasenatdpltsecitom01",
"orasenatdpltinfomgmt03",
"orasenatdoracledigital03",
"orasenatdecanational02",
"orasenatdpublicsector01",
"orasenatdpublicsector02",
"orasenatdpublicsector04",
"orasenatdpublicsector05",
"orasenatdpublicsector06",
"orasenatdpltsecitom03",
"orasenatdpltsecitom02",
"orasenatdecafsitelco01",
"orasenatdoracledigital06",
"orasenatdoracledigital07",
"orasenatdpltsecitom05",
"orasenatdpltdevopsnetw01",
"orasenatdpltoci03"]

new_word = ["orasenatdpublicsector02"]





for t in new_words:
    data = dict()
    data['security'] = list()
    data['iam_security'] = list()
    data["compute_security"] = list()
    print(t)
    r1 = Report(t)
    r2 = ReportNetwork(t)
    data['compute_security'].append(r2.compute)
    data['security'].append(r2.report)
    data['iam_security'].append(r1.report)
    with open(t+'security.json', 'w',encoding="utf-8") as outfile:
        json.dump(data, outfile,ensure_ascii=False,indent=2,sort_keys=True)

print("--- %s seconds ---" % (time.time() - start_time))

